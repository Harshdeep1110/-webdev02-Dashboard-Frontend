function openCardModal(a, b) { var c = document.getElementById("modalOverlay"), d = document.getElementById("cardTitle"), e = document.getElementById("cardDesc"), f = document.getElementById("cardAssignee"), g = document.getElementById("modalTitle"); if (AppState.editingCard = a || null, a && AppState.cards[a]) { var h = AppState.cards[a]; g.textContent = "Edit Card", d.value = h.title, e.value = h.description, f.value = h.assignee, document.querySelectorAll("#colorOptions .color-swatch").forEach(function (a) { a.classList.toggle("active", a.dataset.color === h.color) }), document.querySelectorAll('input[name="priority"]').forEach(function (a) { a.checked = a.value === h.priority }) } else g.textContent = "Add Card", d.value = "", e.value = "", f.value = ""; c.classList.add("active"), d.focus() } function closeCardModal() { document.getElementById("modalOverlay").classList.remove("active"), AppState.editingCard = null } function openColumnModal(a) { var b = document.getElementById("columnModalOverlay"), c = document.getElementById("columnName"), d = document.getElementById("columnModalTitle"); if (AppState.editingColumn = a || null, a) { var e = AppState.columns.find(function (b) { return b.id === a }); d.textContent = "Edit Column", c.value = e.title, document.querySelectorAll("#columnColorOptions .color-swatch").forEach(function (a) { a.classList.toggle("active", a.dataset.color === e.color) }) } else d.textContent = "Add Column", c.value = ""; b.classList.add("active"), c.focus() } function closeColumnModal() { document.getElementById("columnModalOverlay").classList.remove("active"), AppState.editingColumn = null } function confirmDelete(a, b) { var c = document.getElementById("confirmModalOverlay"); document.getElementById("confirmMessage").textContent = a, c.classList.add("active"), AppState.confirmCallback = b } function closeConfirmModal() { document.getElementById("confirmModalOverlay").classList.remove("active"), AppState.confirmCallback = null } function setupModalHandlers() { document.getElementById("closeModal").addEventListener("click", closeCardModal), document.getElementById("cancelModal").addEventListener("click", closeCardModal), document.getElementById("closeColumnModal").addEventListener("click", closeColumnModal), document.getElementById("cancelColumnModal").addEventListener("click", closeColumnModal), document.getElementById("confirmCancel").addEventListener("click", closeConfirmModal), document.getElementById("confirmOk").addEventListener("click", function () { AppState.confirmCallback && AppState.confirmCallback(), closeConfirmModal() }), document.getElementById("saveCard").addEventListener("click", function () { var a = document.getElementById("cardTitle").value.trim(); if (!a) return showToast("Title is required"); var b = document.getElementById("cardDesc").value.trim(), c = document.getElementById("cardAssignee").value.trim(), d = document.querySelector('input[name="priority"]:checked').value, e = document.querySelector("#colorOptions .color-swatch.active").dataset.color; if (AppState.editingCard) { var f = AppState.cards[AppState.editingCard]; f.title = a, f.description = b, f.assignee = c, f.priority = d, f.color = e, addActivity("Updated card: " + a) } else { var g = AppState.columns[0].id, h = generateId(); AppState.cards[h] = { title: a, description: b, assignee: c, priority: d, color: e, columnId: g, order: 999, created: Date.now() }, addActivity("Added card: " + a) } autoSave(), closeCardModal(), renderBoard() }), document.getElementById("saveColumn").addEventListener("click", function () { var a = document.getElementById("columnName").value.trim(); if (!a) return showToast("Name is required"); var b = document.querySelector("#columnColorOptions .color-swatch.active").dataset.color; if (AppState.editingColumn) { var c = AppState.columns.find(function (a) { return a.id === AppState.editingColumn }); c.title = a, c.color = b, addActivity("Updated column") } else AppState.columns.push({ id: generateId(), title: a, color: b, order: AppState.columns.length }), addActivity("Added column: " + a); autoSave(), closeColumnModal(), renderBoard() }), document.querySelectorAll(".color-options").forEach(function (a) { a.addEventListener("click", function (b) { var c = b.target.closest(".color-swatch"); c && (a.querySelectorAll(".color-swatch").forEach(function (a) { a.classList.remove("active") }), c.classList.add("active")) }) }) }
